# K11-BigData-6th-Assignment

## 課題

#### 1. NoSQLが登場した背景を、簡潔に論述してください

- NoSQLが登場する前は、発生したデータを、RDB (Relational Database)にて管理することが一般的であった。RDBでは、構造化された、テーブル的な構造のデータを取り扱うことが可能であった。が、構造化されていないデータを取り扱うには、性能が出ない等の問題があった。2000年代でも、EDI等で企業間の取引データを、インターネットを使って交換しているが、対象データは、業界で標準化された構造化されたデータであった。
- その後、EC (E-Commerce)、SNS(Social Network Service)、等の普及により、JSONなどの半構造化された多様なデータが、Web API等で交換されるようになった。また、スマフォやIoT機器の普及により、インターネット上で発生するデータが膨大になった。
- 大量に発生する多様なデータを扱うのに、RDBは、性能面、コスト面でそぐわなくなり、新たなデータマネジメントシステムとして、NoSQLと称される技術が登場した。
- NoSQL技術は、半構造化データを容易に扱えたり、データを高可用な分散DBとして配置することが可能である、などの特徴を持つ。しかし、RDBと比べて、ソート・集計の機能が弱い、トランザクション管理ができない、等の短所がある。

#### 2. NoSQL利用が適さないユースケースを１つ例示し、その理由を簡潔に論述してください

- 適さないユースケース
    - 在庫品の出荷時に、在庫データの在庫数、等を減らすなどのデータ登録処理
- 理由
    - 障害発生時などでデータが正しくデータベースに登録できなかった場合に、受注数、在庫数などデータが、整合しないことが起きうるため。
    - RDBでは、１回のトランザクション（取引）で行うリソースの更新処理は、すべて実行されるか（コミット）、すべて取り消されるか（ロールバック）のどちらかであることを保証しており、不整合は、起きえない。

#### 3. Cassandraのパーティションキー(partition key)設定にあたっての注意点を論述してください

- Cassandraでは、対象データを、Partition Keyより算出したtokenをもとに、対象ノードを決定して、そのノードに、Partition Keyをキーに、対象データを保持する。同じパーティションキーに複数データがある場合は、クラスタ化カラムでソートされて保持される。
- 対象データが、単一ノードに集中すると、そのノードのI/Oの負荷が上がることになる。より、負荷分散を考慮して、Partition Keyを決定する必要がある。
- データ蓄積を、ノード毎に分散させるには、なるべく要素数の多いデータカラムを、パーティションキーにする。（RDBのインデックス・キーを、パーティションキーにすると、データが分散するとは限らないので注意する。）
- なお、一度、定義したデータスキーマは、変更できない。変更する場合は、データベースの作り直しとなるので注意する。

#### 4. Cassandraのクエリ設計をする際の注意点を簡潔に論述してください

- Partition Keyごとに、蓄積されるデータは、クラスタ化カラムでソートされる。当該の蓄積の仕様を鑑み、Partition Keyとクラスタ化カラムを考慮して、データへアクセスする際のクエリを設計する。
- 原則として、SELECT時は、Partition Keyを指定する必要がある。
- Partition Key以外のキー検索したい場合は、セカンダリー・インデックスという逆引きテーブルを持つこともできる。当該のインデックスを付与した属性で、クエリの抽出条件を指定する。ただ、インデックス作成コストなどで、性能劣化が起きるため、基本は非推奨である。
- マルチキー検索処理は、非推奨である。

以上

